<!doctype html>
<html>

<head>
    <title>Welcome !</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
<h1>Congrats !</h1>


<form action="" method="" class="get-form">
    <h3> GET Request </h3>
    <div class="get-form">
        <label for="get-file">Write a file for GET Request (fileName+extension),
            it has to be an existing data</label>
        <input type="text"
               id="get-file" name="get-file">
    </div>
    <div class="get-form">
        <input type="button" id="get-button" value="GO GET IT!">
    </div>
</form>


<h2> POST </h2>
<div>
    <form method="post"> Select a file to POST:
        <input type="file" name="filePOST" id="filePOST">
        <input type="button" id="buttonPOST" value="Upload file" name="buttonPOST">
    </form>
</div>


<form action="" class="put-form" enctype="multipart/form-data">
    <div class="put-form">
        <label for="put-file">Choose a file for PUT Request</label>
        <input type="file"
               id="put-file" name="put-file"
               accept="text/html, video/mp4, image/png, image/jpg, audio/mp3, video/x-msvideo, text/css, application/pdf, application/vnd.oasis.opendocument.text">
    </div>
    <div class="put-form">
        <input type="submit" id="put-button" value="PUT!">
    </div>
</form>


<form action="" class="delete-form" enctype="multipart/form-data">
    <div class="delete-form">
        <label for="delete-file">Choose an existing file for DELETE Request</label>
        <input type="file"
               id="delete-file" name="delete-file"
               accept="text/html, video/mp4, image/png, image/jpg, audio/mp3, video/x-msvideo, text/css, application/pdf, application/vnd.oasis.opendocument.text">
    </div>
    <div class="delete-form">
        <input type="submit" id="delete-button" value="DELETE!">
    </div>
</form>


<script>
    $(document).ready(function () {


        $("#get-button").click(function (event) {
            let fileName = $("#get-file").val();
            $.ajax({
                url: fileName,
                type: "get", //send it through get method
                success: function (response) {
                    window.location.href = window.location.href + "/" + fileName;
                },
                error: function (xhr) {
                    //Do Something to handle error
                }
            });
        });


        $("#buttonPOST").click(function () {
            let file = $("#filePOST").val();
            if (file !== "") {
                let fileURL = file.split("\\").pop();

                let formData = new FormData();
                formData.append(fileURL, $("#filePOST").prop('files')[0]);
                let settings = {
                    "url": fileURL,
                    "method": "POST",
                    "data": formData,
                    "timeout": 0,
                    "processData": false,
                    "contentType": false,
                    "mimeType": "multipart/form-data",
                    "success": function (response) {
                        alert("File POSTED!");
                    }
                };
                $.ajax(settings).done(function (response) {
                        console.log(response);
                    }
                );

            }
        });


        $("#put-button").click(function () {

            let formData = new FormData();
            let files = $('#put-file')[0].files;
            let fileURL = $('#put-file')[0].files[0].name;
            alert(fileURL);

            var form = new FormData();
            var filename = $('#post-file').val();
            var leafname = filename.split('\\').pop().split('/').pop();
            form.append(leafname, $("#post-file").prop('files')[0]);

            // Check file selected or not
            if (files.length > 0) {
                formData.append('file', files[0]);

                $.ajax({
                    url: 'plan.png',
                    type: 'post',
                    data: form,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        if (response != 0) {
                            alert("file uploaded")
                        } else {
                            alert('file not uploaded');
                        }
                    },
                });
            } else {
                alert("Please select a file.");
            }
        });


        $("#delete-button").click(function () {
            let fileURL = $('#delete-file').val();
            if (fileURL !== null) {
                let params = {
                    url: fileURL,
                    type: 'DELETE',
                    success: function (result) {
                        // do something
                    }
                }
            }


        });


    })
</script>


</body>
</html>